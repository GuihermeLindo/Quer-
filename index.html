<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quer namorar comigo?</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <div class="pergunta">Quer namorar comigo?</div>

    <div id="mensagem" class="mensagem"></div>
    <button id="sim" class="btn sim">Sim</button>
    <button id="nao" class="btn nao">N√£o</button>
    <div id="tag" class="tag">@vs.guiz</div>
  </div>

  <script>
    const botaoSim = document.getElementById("sim");
    const botaoNao = document.getElementById("nao");
    const mensagem = document.getElementById("mensagem");

    let contadorNao = 0;
    let desistiu = false;
    let bloqueado = false;
    let podeContar = true;
    let mostrandoPorQueNao = false;

    const isTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;

    function bloquearBotoes() {
      botaoSim.disabled = true;
      botaoNao.disabled = true;
      botaoSim.style.opacity = 0.5;
      botaoNao.style.opacity = 0.5;
      botaoSim.style.cursor = "not-allowed";
      botaoNao.style.cursor = "not-allowed";
      bloqueado = true;
    }

    botaoSim.addEventListener("click", () => {
      if (bloqueado) return;
      mensagem.textContent = "MUITO OBRIGADO ‚ù§Ô∏è üòç";
      mensagem.style.display = "block";
      mensagem.classList.add("grande");
      bloquearBotoes();
    });

    function mostrarMensagemTemporaria(texto) {
      mensagem.textContent = texto;
      mensagem.style.display = "block";
      mensagem.classList.remove("grande");
      setTimeout(() => {
        mensagem.style.display = "none";
      }, 2000);
    }

    function moverBotaoRandom() {
      const largura = window.innerWidth - botaoNao.offsetWidth;
      const altura = window.innerHeight - botaoNao.offsetHeight;
      const novaEsquerda = Math.floor(Math.random() * largura);
      const novoTopo = Math.floor(Math.random() * altura);
      botaoNao.style.left = `${novaEsquerda}px`;
      botaoNao.style.top = `${novoTopo}px`;
      botaoNao.style.transform = "translate(0, 0)";
    }

    function moverBotaoParaForaDoMouse(mouseX, mouseY) {
      const largura = window.innerWidth - botaoNao.offsetWidth;
      const altura = window.innerHeight - botaoNao.offsetHeight;

      const botaoRect = botaoNao.getBoundingClientRect();

      // Dist√¢ncia entre mouse e centro do bot√£o
      const botaoCenterX = botaoRect.left + botaoNao.offsetWidth / 2;
      const botaoCenterY = botaoRect.top + botaoNao.offsetHeight / 2;
      const distanciaX = mouseX - botaoCenterX;
      const distanciaY = mouseY - botaoCenterY;
      const distancia = Math.sqrt(distanciaX * distanciaX + distanciaY * distanciaY);

      // Se o mouse estiver muito perto (menos de 150px), move o bot√£o para o lado oposto
      if (distancia < 150) {
        // Vetor invertido normalizado para afastar o bot√£o
        let vetorX = botaoCenterX - mouseX;
        let vetorY = botaoCenterY - mouseY;
        const magnitude = Math.sqrt(vetorX * vetorX + vetorY * vetorY) || 1;
        vetorX /= magnitude;
        vetorY /= magnitude;

        // Nova posi√ß√£o a 200px do mouse na dire√ß√£o oposta
        let novaEsquerda = mouseX + vetorX * 200 - botaoNao.offsetWidth / 2;
        let novoTopo = mouseY + vetorY * 200 - botaoNao.offsetHeight / 2;

        // Limitar dentro da janela
        novaEsquerda = Math.min(Math.max(0, novaEsquerda), largura);
        novoTopo = Math.min(Math.max(0, novoTopo), altura);

        botaoNao.style.left = `${novaEsquerda}px`;
        botaoNao.style.top = `${novoTopo}px`;
        botaoNao.style.transform = "translate(0, 0)";
      }
    }

    function reacaoBotaoNao() {
      if (!podeContar || bloqueado) return;
      podeContar = false;
      setTimeout(() => podeContar = true, 200); // 200ms delay

      contadorNao++;

      if (desistiu && contadorNao > 10) {
        mensagem.textContent = "Eu te odeio üò°";
        mensagem.style.display = "block";
        mensagem.classList.add("grande");
        bloquearBotoes();
        return;
      }

      if (contadorNao === 3) {
        mostrarMensagemTemporaria("Tem certeza?");
      } else if (contadorNao === 5) {
        mostrandoPorQueNao = true;
        mostrarMensagemTemporaria("Por que n√£o?");
        // Continua fugindo mas sem mensagens repetidas
      } else if (contadorNao === 10) {
        mensagem.textContent = "Desisto...";
        mensagem.style.display = "block";
        mensagem.classList.remove("grande");

        setTimeout(() => {
          botaoNao.style.top = "60%";
          botaoNao.style.left = "60%";
          botaoNao.style.transform = "translate(-50%, -50%)";
          desistiu = true;
        }, 1500);
      } else {
        moverBotaoRandom();
      }
    }

    if (isTouch) {
      botaoNao.addEventListener("click", reacaoBotaoNao);
    } else {
      window.addEventListener("mousemove", (e) => {
        if (bloqueado) return;

        // Se estamos na fase "Por que n√£o?", s√≥ mover o bot√£o sempre que o mouse se aproximar
        if (mostrandoPorQueNao) {
          moverBotaoParaForaDoMouse(e.clientX, e.clientY);
          return;
        }

        // Se estiver perto do bot√£o, mover e contar o evento
        const botaoRect = botaoNao.getBoundingClientRect();
        const botaoCenterX = botaoRect.left + botaoNao.offsetWidth / 2;
        const botaoCenterY = botaoRect.top + botaoNao.offsetHeight / 2;
        const distanciaX = e.clientX - botaoCenterX;
        const distanciaY = e.clientY - botaoCenterY;
        const distancia = Math.sqrt(distanciaX * distanciaX + distanciaY * distanciaY);

        if (distancia < 150) {
          reacaoBotaoNao();
        }
      });
    }
  </script>
</body>
</html>
